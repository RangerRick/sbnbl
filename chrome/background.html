<script src="common.js"></script>
<script src="dao.js"></script>
<script>
var send_update = function(data) {
	if (debug) console.log("sending update: data = " + JSON.stringify(data));
	chrome.tabs.getSelected(null, function(tab) {
		chrome.tabs.sendRequest(tab.id, {"config_update": data}, function(response) {
		});
	});
}

chrome.extension.onRequest.addListener(function(request, sender, sendResponse) {
	if (request.action == "force_refresh") {
		if (debug) console.log("forcing a refresh");
		do_update();
	} else {
		console.log("received unknown request: " + request);
	}
	sendResponse({});
});

do_update();
</script>
