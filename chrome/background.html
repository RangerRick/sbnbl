<script src="common.js"></script>
<script src="dao.js"></script>
<script>
var send_update = function(users) {
	if (debug) console.debug("sending update: users = " + JSON.stringify(users));
	chrome.tabs.getSelected(null, function(tab) {
		chrome.tabs.sendRequest(tab.id, {"user_update": users}, function(response) {
		});
	});
}

chrome.extension.onRequest.addListener(function(request, sender, sendResponse) {
	if (request.action == "force_refresh") {
		if (debug) console.debug("forcing a refresh");
		do_update();
	} else {
		console.debug("received unknown request: " + request);
	}
	sendResponse({});
});

do_update();
</script>
