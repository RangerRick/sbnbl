<script src="common.js"></script>
<script src="dao.js"></script>
<script>
// called by do_update to actually send the update
var send_update = function(data) {
	if (debug) console.log("sending update: data = " + JSON.stringify(data));
	safari.application.activeBrowserWindow.activeTab.page.dispatchMessage("config_update", data);
}

safari.application.addEventListener("message", function(messageEvent) {
	if (messageEvent.name == "force_refresh") {
		if (debug) console.log("forcing a refresh");
		do_update();
	}
}, false);

do_update();
</script>
